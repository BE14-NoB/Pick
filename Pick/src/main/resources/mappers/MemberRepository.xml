<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.nob.pick.member.query.infrastructure.repository.MemberRepository">
    <!-- 이름과 전화번호로 이메일 찾기 -->
    <select id="findEmailByNameAndPhone" parameterType="map" resultType="string">
        SELECT email
        FROM member
        WHERE name = #{name}
          AND phone_number = #{phoneNumber}
    </select>

    <!-- 이름, 전화번호, 이메일로 비밀번호 찾기 -->
    <select id="findPasswordByNamePhoneAndEmail" parameterType="map" resultType="string">
        SELECT password
        FROM member
        WHERE name = #{name}
          AND phone_number = #{phoneNumber}
          AND email = #{email}
    </select>

    <!-- 모든 회원 조회 -->
    <select id="findAllMembers" resultType="com.nob.pick.member.query.vo.RequestMemberVO">
        SELECT id,
               name,
               age,
               ihidnum,
               phone_number,
               email,
               password,
               nickname,
               status,
               reported_count,
               user_grant
        FROM member
    </select>

    <!-- ID로 특정 회원 조회 -->
    <select id="findMemberById" parameterType="int" resultType="com.nob.pick.member.query.vo.RequestMemberVO">
        SELECT id,
               name,
               age,
               ihidnum,
               phone_number,
               email,
               password,
               nickname,
               status,
               reported_count,
               user_grant
        FROM member
        WHERE id = #{id}
    </select>

    <!-- ID로 회원 상태 조회 -->
    <select id="findMemberStatusById" parameterType="int" resultType="com.nob.pick.member.query.vo.Status">
        SELECT status
        FROM member
        WHERE id = #{id}
    </select>

    <!-- 이메일 중복 여부 확인 -->
    <select id="existsByEmail" parameterType="string" resultType="boolean">
        SELECT EXISTS(SELECT 1
                      FROM member
                      WHERE email = #{email})
    </select>

        <!-- 전화번호 중복 여부 확인 -->
        <select id="existsByPhoneNumber" parameterType="string" resultType="boolean">
            SELECT EXISTS(
                SELECT 1
                FROM member
                WHERE phone_number = #{phoneNumber}
            )
        </select>
</mapper>